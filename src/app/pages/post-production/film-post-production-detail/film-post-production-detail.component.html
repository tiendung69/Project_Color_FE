<div style="display: flex; flex-direction: column; align-items: center; justify-content: center; margin-top: -30px;">
  <div style="display: flex; align-items: center; margin-top: 40px; width: 50%; margin-bottom: -30px">
    <div style="border-bottom: 1px solid #000; flex-grow: 1; width: 25%;"></div>
    <div style="flex-grow: 1; text-align: center;">
      <div style="padding: 0 10px; font-size: 25px; font-family: 'Museo Sans Rounded'; font-weight: 900;" class="label-title;">THÔNG TIN CHUNG</div>
    </div>
    <div style="border-bottom: 1px solid #000; flex-grow: 1; width: 25%;"></div>
  </div>
</div>

<label class="label-title" style="margin-top: 25px;">Kế hoạch sản xuất hậu kỳ</label>

<div class="d-flex container-collapse" (click)="toggleCollapse()">
  <div class="fa-1x mx-4 my-3">
    <i [className]="isCollasped ? 'fa fa-plus' : 'fa fa-minus'"></i>
  </div>
  <span class="label-custom">Thông tin sản xuất hậu kỳ</span>
</div>
<form [ngbCollapse]="isCollasped" (ngSubmit)="onSubmit()" #form="ngForm">
  <div id="collapseExample">
    <div class="card">
      <div class="card-body">
        <div class="row">
          <div class="form-group col-md-4" style="margin-top: 8px">
            <label class="label-custom">Phim*</label>
            <ejs-dropdownlist
              [dataSource]="listPlan"
              [readonly]="!enableForm || listPostProduction.Status != undefined"
              (change)="onChange($event)"
              [fields]="dropdownList"
              placeHolder="Chọn phim"
              [value]="listPostProduction.PreProductionId"
            >
            </ejs-dropdownlist>
            <p *ngIf="messagePlan" style="color: red">
              Thông tin này là bắt buộc.
            </p>
          </div>

          <div class="form-group col-md-4" style="margin-top: 8px">
            <label class="label-custom">Thời gian bắt đầu</label>
            <ejs-datepicker
              [readonly]="!enableForm || listPostProduction.Status >= 3 || this.listPostProduction.Status == -5"
              [value]="listPostProduction.FromDate"
              (valueChange)="onInputChange({ key: 'FromDate', value: $event })"
              placeholder="Chọn thời gian thực hiện"
              format="dd/MM/yyyy"
            >
            </ejs-datepicker>
          </div>

          <div class="form-group col-md-4" style="margin-top: 8px">
            <label class="label-custom">Thời gian kết thúc</label>
            <ejs-datepicker
              [readonly]="!enableForm || listPostProduction.Status >= 3  || this.listPostProduction.Status == -5"
              [value]="listPostProduction.ToDate"
              (valueChange)="onInputChange({ key: 'ToDate', value: $event })"
              placeholder="Chọn thời gian kết thúc"
              format="dd/MM/yyyy"
            >
            </ejs-datepicker>
          </div>

          <div class="form-group col-md-4" style="margin-top: 8px">
            <label class="label-custom">Ngân sách</label>
            <ejs-textbox
              [readonly]="!enableForm || listPostProduction.Status >= 3  || this.listPostProduction.Status == -5"
              type="number"
              [value]="listPostProduction.Budget"
              (valueChange)="onChangeBudget($event)"
              placeHolder="Ngân sách"
            >
            </ejs-textbox>
          </div>

          <div class="form-group col-md-4" style="margin-top: 8px">
            <label class="label-custom">Nội dung thực hiện</label>
            <ejs-textbox
              [multiline]="true"
              [readonly]="!enableForm || listPostProduction.Status >=3 || this.listPostProduction.Status == -5"
              [value]="listPostProduction.WorkContent"
              (valueChange)="
                onInputChange({ key: 'WorkContent', value: $event })
              "
              placeHolder="Nội dung thực hiện"
            >
            </ejs-textbox>
          </div>
        </div>
        <div
          class="row col justify-content-center mt-5"
          *ngIf="
            listPostProduction.Status == 0 ||
            listPostProduction.Status == 1 ||
            listPostProduction.Status == 2 ||
            listPostProduction.Status == undefined 
          "
        >
          <button
            *ngIf="enableForm"
            class="btn btn-secondary btn-custom mr-4 btn-custom-large py-2"
            type="button"
            (click)="onCancelClick()"
          >
            Hủy
          </button>
          <button
            *ngIf="enableForm"
            class="btn btn-primary btn-custom btn-custom-large py-2"
            type="submit"
            content="Save"
          >
            Lưu
          </button>
        </div>
      </div>
    </div>
  </div>
</form>
<div class="hr" *ngIf="listPostProduction.Status > 2  || this.listPostProduction.Status == -5"></div>
<div class="hr" *ngIf="listPostProduction.Status > 2 || this.listPostProduction.Status == -5"></div>
<div class="hr" *ngIf="listPostProduction.Status > 2 || this.listPostProduction.Status == -5"></div>
<label *ngIf="listPostProduction.Status > 2  || this.listPostProduction.Status == -5" class="label-title"
  >Quá trình sản xuất</label
>
<div class="hr" *ngIf="listPostProduction.Status > 2"></div>

<!-- Show spinner overlay -->
<!-- <div *ngIf="isCreating" class="spinner-overlay">
  <div class="spinner-overlay-content"></div>
</div> -->
<div
  *ngIf="listPostProduction.Status > 2  || this.listPostProduction.Status == -5"
  [ngbCollapse]="idPostPlan ? false : true"
>
  <div class="d-flex container-collapse" (click)="toggleCollapse3()">
    <div class="fa-1x mx-4 my-3">
      <i [className]="isCollasped3 ? 'fa fa-plus' : 'fa fa-minus'"></i>
    </div>
    <span class="label-custom">Tiến độ sản xuất</span>
  </div>
  <ejs-grid
    #gridProgress
    [dataSource]="listPostProgress"
    [toolbar]="toolbarOptions"
    [allowTextWrap]="true"
    [editSettings]="editSettings2"
    [pageSettings]="pageSettings"
    [allowPaging]="true"
    (actionBegin)="actionBegin($event)"
    (actionComplete)="actionComplete($event)"
    [ngbCollapse]="isCollasped3"
  >
    <e-columns>
     
      <e-column
        field="FromDate"
        type="date"
        format="dd/MM/yyyy"
        textAlign="Center"
        headerText="Thời gian bắt đầu"
      >
        <ng-template #template let-data>
          {{ data.FromDate | date : "dd/MM/yyyy" }}
        </ng-template>

        <ng-template #editTemplate let-data>
          <div class="multiline">
            <ejs-datepicker
              name="FromDate"
              #default
              [value]="data.FromDate"
              floatLabelType="Auto"
              rows="1"
              placeholder="Thời gian bắt đầu"
              (valueChange)="
                onInputChangeProgress({ key: 'FromDate', value: $event })
              "
            ></ejs-datepicker>
          </div>
        </ng-template>
      </e-column>
      <e-column
        field="ToDate"
        type="date"
        format="dd/MM/yyyy"
        textAlign="Center"
        headerText="Thời gian kết thúc"
      >
        <ng-template #template let-data>
          {{ data.ToDate | date : "dd/MM/yyyy" }}
        </ng-template>

        <ng-template #editTemplate let-data>
          <div class="multiline">
            <ejs-datepicker
              name="ToDate"
              #default
              [value]="data.ToDate"
              floatLabelType="Auto"
              rows="1"
              (valueChange)="
                onInputChangeProgress({ key: 'ToDate', value: $event })
              "
              placeholder="Thời gian kết thúc"
            ></ejs-datepicker>
          </div>
        </ng-template>
      </e-column>
      <e-column
        field="TotalProgress"
        type="number"
        textAlign="Center"
        headerText="Tiến độ quá trình"
        headerTextAlign="Center"
      >
        <ng-template #template let-data>
          {{ data.TotalProgress + "%" }}
        </ng-template>

        <ng-template #editTemplate let-data>
          <div class="multiline">
            <ejs-textbox
              name="TotalProgress"
              #default
              type="number"
              [value]="data.TotalProgress"
              floatLabelType="Auto"
              rows="1"
              placeholder="Tiến độ quá trình(%)"
              (valueChange)="onInputChangeProgressPercent($event)"
            ></ejs-textbox>
          </div>
        </ng-template>
      </e-column>
      <e-column field="ExpenseTypeNavigation.Name" headerText="Loại chi phí" headerTextAlign="Center" textAlign="Center"></e-column>
      <e-column
        field="Expense"
        type="number"
        textAlign="Center"
        headerText="Chi phí"
        headerTextAlign="Center"
      >
        <ng-template #editTemplate let-data>
          <div class="multiline">
            <ejs-textbox
              name="Expense"
              #default
              type="number"
              [value]="data.Expense"
              floatLabelType="Auto"
              rows="1"
              placeholder="Chi phí"
              (valueChange)="onInputChangeProgressExpense($event)"
            ></ejs-textbox>
          </div>
        </ng-template>
      </e-column>
      <e-column field="Note" headerText="Ghi chú" width="250px">
        <ng-template #editTemplate let-data>
          <div class="multiline">
            <ejs-textbox
              name="Note"
              #default
              [value]="data.Note"
              floatLabelType="Auto"
              rows="1"
              placeholder="Ghi chú"
              (valueChange)="
                onInputChangeProgress({ key: 'Note', value: $event })
              "
            ></ejs-textbox>
          </div>
        </ng-template>
      </e-column>
      <e-column
        field="IsFinished"
        headerText="Trạng thái tiến độ"
        [template]="templateStatus"
        [editTemplate]="editTemplate"
        width="150px"
      >
        <ng-template #templateStatus let-data>
          {{ rederStatus(data) }}
        </ng-template>
        <ng-template #editTemplate let-data>
          <ejs-dropdownlist
            [dataSource]="listStatus"
            [fields]="fieldDropdown"
            [value]="data.IsFinished"
            placeholder="Trạng thái tiến độ"
            floatLabelType="Auto"
            (valueChange)="
              onInputChangeProgress({ key: 'IsFinished', value: $event })
            "
          >
          </ejs-dropdownlist>
        </ng-template>
      </e-column>
    </e-columns>
  </ejs-grid>
</div>
<div class="hr"></div>
<div
  class="d-flex container-collapse"
  (click)="toggleCollapse4()"
  *ngIf="listPostProduction.Status >2  || this.listPostProduction.Status == -5"
>
  <div class="fa-1x mx-4 my-3">
    <i [className]="isCollasped4 ? 'fa fa-plus' : 'fa fa-minus'"></i>
  </div>
  <span class="label-custom">Kết thúc sản suất hậu kỳ</span>
</div>

<form (ngSubmit)="onSubmit2()" #form="ngForm">
  <div [ngbCollapse]="isCollasped4" id="collapseExample">
    <div class="card">
      <div class="card-body">
        <div class="row">
          <div class="form-group col-md-4" style="margin-top: -7px">
            <label class="label-custom">Thời gian đóng</label>
            <ejs-datepicker
              [readonly]="!enableForm || listPostProduction.Status === 5"
              [value]="listPostProduction.CloseDate"
              placeholder="Thời gian đóng"
              (valueChange)="
                onInputChange2({ key: 'CloseDate', value: $event })
              "
              format="dd/MM/yyyy"
            >
            </ejs-datepicker>
          </div>

          <div class="form-group col-md-4" style="margin-top: -7px">
            <label class="label-custom">Lý do đóng</label>
            <ejs-textbox
              placeholder="Lý do đóng"
              [readonly]="!enableForm || listPostProduction.Status === 5"
              [value]="listPostProduction.CloseReason"
              (valueChange)="
                onInputChange2({ key: 'CloseReason', value: $event })
              "
            >
            </ejs-textbox>
          </div>

          <div class="form-group col-md-4" style="margin-top: -7px">
            <label class="label-custom">Ghi chú</label>
            <ejs-textbox
              placeholder="Ghi chú"
              [readonly]="!enableForm || listPostProduction.Status === 5"
              [value]="listPostProduction.CloseNote"
              (valueChange)="
                onInputChange2({ key: 'CloseNote', value: $event })
              "
            >
            </ejs-textbox>
          </div>

        
          <div class="form-group col-md-12" style="margin-top: 15px">
            <label class="label-custom">Phim hoàn chỉnh</label>
            <ejs-grid
              #gridVideo
              [dataSource]="listVideo"
              [toolbar]="toolbarOptions"
              [editSettings]="editSettings"
              [allowPaging]="true"
              [allowSorting]="true"
              [allowTextWrap]="true"
              [pageSettings]="{ pageSize: 5 }"
              (actionBegin)="actionBeginVideo($event)"
              (actionComplete)="actionCompleteVideo($event)"
              (rowDataBound)="rowDataBound($event)"
              (commandClick)="commandClick($event)"
            >
              <e-columns>
                <e-column field="VideoUrl" headerText="Tên phim*" width="40%">
                  <ng-template let-data #template
                    >
                    <a
                      style="cursor: pointer"
                      *ngIf="data.VideoUrl"
                      data-toggle="tooltip"
                      data-placement="top"
                      title="{{ data.Note }}"
                      (click)="onFileUrlClick(data.VideoUrl)"
                    >
                      {{ getFileName(data.VideoUrl) }}
                    </a></ng-template
                  >
                  <ng-template #editTemplate let-data>
                    <label class="label-custom" for="">Phim</label>
                    <div
                      class="input-group file-upload"
                      *ngIf="!data?.VideoUrl; else other_content"
                    >
                      <input
                        type="file"
                        placeholder="aaaaa"
                        (change)="fileChange(input)"
                        #input
                        class="file-upload-btn"
                      />
                      <input
                        type="text"
                        class="form-control"
                        placeholder="Choose a file..."
                        value="{{ file }}"
                      />
                      <i
                        class="fa fa-times delete-file"
                        (click)="removeFile()"
                        *ngIf="file"
                      ></i>
                      <span class="input-group-append">
                        <button class="btn btn-primary" type="button">
                          <i class="fa fa-upload"></i>
                        </button>
                      </span>
                    </div>
                    <ng-template #other_content
                      ><a
                        style="cursor: pointer"
                        class="form-control"
                        *ngIf="data.VideoUrl"
                        data-toggle="tooltip"
                        data-placement="top"
                        title="{{ data.Note }}"
                        (click)="onFileUrlClick(data.VideoUrl)"
                      >
                        {{ getFileName(data.VideoUrl) }}
                      </a></ng-template
                    >
                    <p *ngIf="messageFile" style="color: red; margin-top: 7px">
                      Thông tin này là bắt buộc.
                    </p>
                  </ng-template>
                </e-column>
                <e-column field="Note" headerText="Mô tả" width="40%">
                  <ng-template #editTemplate let-data>
                    <label class="label-custom" for="">Mô Tả</label>
                    <div class="multiline">
                      <app-textarea-input
                        [multiline]="true"
                        key="Note"
                        [value]="data.Note"
                        floatType
                        (newItemEvent)="onInputVideoChange($event)"
                        placeHolder="Mô Tả"
                      ></app-textarea-input>
                    </div>
                  </ng-template>
                </e-column>
                <!-- <e-column
        field="VideoSize"
        headerText="Dung lượng video"
        width="20%"

      ></e-column> -->
      <e-column
      headerText=""
      textAlign="Center"
      width="90px"
      [commands]="commands"
    >
    </e-column>
              </e-columns>
            </ejs-grid>
          </div>
          <div
          class="row col justify-content-center mt-5"
          *ngIf="!closeRejectApproved && enableForm"
        >
          <button
            class="btn btn-secondary btn-custom mr-4 btn-custom-large py-2"
            type="button"
            (click)="onCancelClick()"
          >
            Hủy
          </button>
          <button
            class="btn btn-primary btn-custom btn-custom-large py-2"
            type="submit"
            content="Save"
          >
            Lưu
          </button>
        </div>
        </div>
      </div>
    </div>
  </div>
</form>


<div *ngIf="idPostPlan" style="display: flex; flex-direction: column; align-items: center; justify-content: center; margin-top: -30px;">
  <div *ngIf="listPostProduction.Status !== 0 || enableApprove" style="display: flex; align-items: center; margin-top: 65px; width: 50%; margin-bottom: -30px">
    <div style="border-bottom: 1px solid #000; flex-grow: 1; width: 25%;"></div>
    <div style="flex-grow: 1; text-align: center;">
      <div style="padding: 0 10px; font-size: 25px; font-family: 'Museo Sans Rounded'; font-weight: 900;" class="label-title;">LÃNH ĐẠO DUYỆT</div>
    </div>
    <div style="border-bottom: 1px solid #000; flex-grow: 1; width: 25%;"></div>
  </div>
</div>


<div *ngIf="listPostProduction.Status !== 0 || enableApprove">
  <label
    *ngIf="idPostPlan"
    class="label-title"
    style="width: 100%; margin-top: 25px; margin-bottom: 16px"
    >Phê duyệt kế hoạch sản xuất hậu kỳ</label
  >
  <div [ngbCollapse]="idPostPlan ? false : true">
    <div class="d-flex container-collapse" (click)="toggleCollapse2()">
      <div class="fa-1x mx-4 my-3">
        <i [className]="isCollasped2 ? 'fa fa-plus' : 'fa fa-minus'"></i>
      </div>
      <span class="label-custom">Thông tin phê duyệt</span>
    </div>
    <div [ngbCollapse]="isCollasped2" id="collapseExample">
      <div class="card">
        <div class="card-body">
          <form>
            <div class="row" *ngIf="aprovedTimes > 0">
              <div class="form-group col-3">
                <label class="label-custom" for="Name">Người duyệt: </label>
                <span>
                  {{ handleRenderMember(approvedDetail.ProcessedBy) }}</span
                >
              </div>
              <div class="form-group col-3">
                <label class="label-custom" for="Name">Ngày duyệt: </label>
                <span *ngIf="approvedDetail.ProcessedAt">
                  {{ handleRenderDate(approvedDetail.ProcessedAt) }}</span
                >
              </div>
              <div class="form-group col-3">
                <label class="label-custom" for="Name">Kết quả duyệt: </label>
                <span> {{ handleRenderResult(approvedDetail.Result) }}</span>
              </div>
              <div class="form-group col-3">
                <label class="label-custom" for="Name">Lần duyệt: </label>
                <span> {{ aprovedTimes }}</span>
              </div>
            </div>
            <!-- <div class="row" *ngIf="aprovedTimes1 > 0">
              <div class="form-group col-3">
                <label class="label-custom" for="Name"
                  >Người duyệt đóng:
                </label>
                <span>
                  {{ handleRenderMember(approvedClose.ProcessedBy) }}</span
                >
              </div>
              <div class="form-group col-3">
                <label class="label-custom" for="Name">Ngày duyệt đóng: </label>
                <span *ngIf="approvedClose.ProcessedAt">
                  {{ handleRenderDate(approvedClose.ProcessedAt) }}</span
                >
              </div>
              <div class="form-group col-3">
                <label class="label-custom" for="Name"
                  >Kết quả duyệt đóng:
                </label>
                <span> {{ handleRenderResult(approvedClose.Result) }}</span>
              </div>
              <div class="form-group col-3">
                <label class="label-custom" for="Name">Lần duyệt đóng: </label>
                <span> {{ aprovedTimes1 }}</span>
              </div>
            </div> -->

            <div class="row">
              <div class="form-group col">
                <label class="label-custom" for="Name">Nhận xét: </label>
                <app-textarea-input
                  [multiline]="true"
                  [readonly]="!enableApprove"
                  (newItemEvent)="onInputComment($event)"
                  key="Comment"
                  [value]="
                    approvedDetail !== undefined ? approvedDetail.Comment : ''
                  "
                  placeHolder="Nhập nhận xét..."
                ></app-textarea-input>
              </div>
            </div>
            <div
              class="row justify-content-center mt-4 mb-5"
              *ngIf="enableApprove || listPostProduction.Status == 1"
            >
              <button
                class="btn btn-secondary btn-custom mr-4 btn-custom-large py-2"
                type="button"
                *ngIf="showApprove"
                (click)="onSubmitApprove(status.REJECT)"
              >
                Từ chối
              </button>
              <button
                *ngIf="showApprove || listPostProduction.Status == 3 || listPostProduction.Status == 1"
                class="btn btn-primary btn-custom btn-custom-large py-2"
                type="submit"
                content="Save"
                (click)="onSubmitApprove(status.APPROVE)"
              >
                Phê duyệt
              </button>
              <!-- <button
                class="btn btn-secondary btn-custom mr-4 btn-custom-large py-2"
                type="button"
                (click)="onSubmitApproveClose(status.REJECT)"
                *ngIf="
                  listPostProduction.Status == 4 ||
                  listPostProduction.Status == -5
                "
              >
                Từ chối
              </button>

              <button
                class="btn btn-primary btn-custom btn-custom-large py-2"
                type="submit"
                content="Save"
                (click)="onSubmitApproveClose(status.APPROVE)"
                *ngIf="
                  listPostProduction.Status == 4 ||
                  listPostProduction.Status == -5 ||
                  listPostProduction.Status == 5
                "
              >
                Duyệt đóng
              </button> -->
            </div>
          </form>
        </div>
      </div>
      <div #container class="root-container"></div>
    </div>
  </div>
</div>

<div [ngbCollapse]="idPostPlan ? false : true" style="margin-top: 10px" *ngIf="listPostProduction.Status !== 0 || enableApprove">
  <div class="d-flex container-collapse" (click)="toggleCollapse5()">
    <div class="fa-1x mx-4 my-3">
      <i [className]="isCollasped5 ? 'fa fa-plus' : 'fa fa-minus'"></i>
    </div>
    <span class="label-custom">Lịch sử phê duyệt</span>
  </div>
  <div *ngIf="listApproved.length === 0" class="no-approval-history">
    <div [ngbCollapse]="isCollasped5">
      <div
        class="card"
        style="margin-top: 10px; border: 0px"
        style="height: 57px"
      >
        <div class="card-body">
          <p style="color: red">Chưa có lượt duyệt nào.</p>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="listApproved && listApproved.length">
    <div *ngFor="let item of listApproved ; let i = index">
      <div [ngbCollapse]="isCollasped5">
        <div class="card" style="margin-top: -5px">
          <div class="card-body">
            <form>
              <div class="row" *ngIf="aprovedTimes > 0">
                <div class="form-group col-3">
                  <label class="label-custom" for="Name">Người duyệt: </label>
                  <span> {{ handleRenderMember(item.ProcessedBy) }}</span>
                </div>
                <div class="form-group col-3">
                  <label class="label-custom" for="Name">Ngày duyệt: </label>
                  <span *ngIf="item.ProcessedAt">
                    {{ handleRenderDate(item.ProcessedAt) }}</span
                  >
                </div>
                <div class="form-group col-3">
                  <label class="label-custom" for="Name">Kết quả duyệt: </label>
                  <span> {{ handleRenderResult(item.Result) }}</span>
                </div>
                <div class="form-group col-3">
                  <label class="label-custom" for="Name"
                    >Lần duyệt:&nbsp;</label
                  >
                  <span>{{ aprovedTimes - i }}</span>
                </div>
              </div>
              <div class="row">
                <div class="form-group col">
                  <label
                    class="label-custom"
                    for="Name"
                    (click)="toggleCommentVisibility(i)"
                  >
                    <div style="display: flex; align-items: center">
                      <div
                        style="
                          margin-right: 10px;
                          font-size: 23px;
                          margin-top: -6px;
                        "
                      >
                        {{
                          i === selectedCommentIndex && isCommentVisible
                            ? "-"
                            : "+"
                        }}
                      </div>
                      Nhận xét
                    </div>
                  </label>
                </div>
              </div>

              <div
                class="row"
                *ngIf="isCommentVisible && i === selectedCommentIndex"
              >
                <div class="form-group col">
                  <app-textarea-input
                    [multiline]="true"
                    [readonly]="true"
                    (newItemEvent)="onInputComment($event)"
                    key="Comment"
                    [value]="item !== undefined ? item.Comment : ''"
                  ></app-textarea-input>
                </div>
              </div>
            </form>
          </div>
        </div>
        <div #container class="root-container"></div>
      </div>
    </div>
  </div>

<div *ngIf="checkApproved">
<div *ngIf="listPostProduction.Status !== 0 || enableApprove">
  <label
    *ngIf="idPostPlan"
    class="label-title"
    style="width: 100%; margin-top: 50px; margin-bottom: 16px"
    >Phê duyệt đóng sản xuất hậu kỳ</label
  >
  <div [ngbCollapse]="idPostPlan ? false : true">
    <div class="d-flex container-collapse" (click)="toggleCollapse7()">
      <div class="fa-1x mx-4 my-3">
        <i [className]="isCollasped7 ? 'fa fa-plus' : 'fa fa-minus'"></i>
      </div>
      <span class="label-custom">Thông tin phê duyệt</span>
    </div>
    <div [ngbCollapse]="isCollasped7" id="collapseExample">
      <div class="card">
        <div class="card-body">
          <form>
            <div class="row" *ngIf="aprovedTimes1 > 0">
              <div class="form-group col-3">
                <label class="label-custom" for="Name"
                  >Người duyệt đóng:
                </label>
                <span>
                  {{ handleRenderMember(approvedClose.ProcessedBy) }}</span
                >
              </div>
              <div class="form-group col-3">
                <label class="label-custom" for="Name">Ngày duyệt đóng: </label>
                <span *ngIf="approvedClose.ProcessedAt">
                  {{ handleRenderDate(approvedClose.ProcessedAt) }}</span
                >
              </div>
              <div class="form-group col-3">
                <label class="label-custom" for="Name"
                  >Kết quả duyệt đóng:
                </label>
                <span> {{ handleRenderResult(approvedClose.Result) }}</span>
              </div>
              <div class="form-group col-3">
                <label class="label-custom" for="Name">Lần duyệt đóng: </label>
                <span> {{ aprovedTimes1 }}</span>
              </div>
            </div>

            <div class="row">
              <div class="form-group col">
                <label class="label-custom" for="Name">Nhận xét: </label>
                <app-textarea-input
                  [multiline]="true"
                  [readonly]="!enableApprove"
                  (newItemEvent)="onInputCommentClose($event)"
                  key="Comment"
                  [value]="
                    approvedClose !== undefined ? approvedClose.Comment : ''
                  "
                  placeHolder="Nhập nhận xét..."
                ></app-textarea-input>
              </div>
            </div>
            <div
              class="row justify-content-center mt-4 mb-5"
              *ngIf="enableApprove"
            >
              <!-- <button
                class="btn btn-secondary btn-custom mr-4 btn-custom-large py-2"
                type="button"
                *ngIf="showApprove"
                (click)="onSubmitApprove(status.REJECT)"
              >
                Từ chối
              </button>
              <button
                *ngIf="showApprove || listPostProduction.Status == 3"
                class="btn btn-primary btn-custom btn-custom-large py-2"
                type="submit"
                content="Save"
                (click)="onSubmitApprove(status.APPROVE)"
              >
                Phê duyệt
              </button> -->
              <button
                class="btn btn-secondary btn-custom mr-4 btn-custom-large py-2"
                type="button"
                (click)="onSubmitApproveClose(status.REJECT)"
                *ngIf="
                  listPostProduction.Status == 4 ||
                  listPostProduction.Status == -5
                "
              >
                Từ chối
              </button>

              <button
                class="btn btn-primary btn-custom btn-custom-large py-2"
                type="submit"
                content="Save"
                (click)="onSubmitApproveClose(status.APPROVE)"
                *ngIf="
                  listPostProduction.Status == 4 ||
                  listPostProduction.Status == -5 ||
                  listPostProduction.Status == 5
                "
              >
                Duyệt đóng
              </button>
            </div>
          </form>
        </div>
      </div>
      <div #container class="root-container"></div>
    </div>
  </div>
</div>




  <div [ngbCollapse]="idPostPlan ? false : true" style="margin-top: 10px">
    <div class="d-flex container-collapse" (click)="toggleCollapse6()">
      <div class="fa-1x mx-4 my-3">
        <i [className]="isCollasped6 ? 'fa fa-plus' : 'fa fa-minus'"></i>
      </div>
      <span class="label-custom">Lịch sử phê duyệt</span>
    </div>
    <div *ngIf="listApprovedClose.length === 0" class="no-approval-history">
      <div [ngbCollapse]="isCollasped6">
        <div
          class="card"
          style="margin-top: 10px; border: 0px"
          style="height: 57px"
        >
          <div class="card-body">
            <p style="color: red">Chưa có lượt  duyệt nào.</p>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="listApprovedClose && listApprovedClose.length">
      <div *ngFor="let item of listApprovedClose; let i = index">
        <div [ngbCollapse]="isCollasped6">
          <div class="card" style="margin-top: -5px">
            <div class="card-body">
              <form>
                <div class="row" *ngIf="aprovedTimes > 0">
                  <div class="form-group col-3">
                    <label class="label-custom" for="Name">Người duyệt: </label>
                    <span> {{ handleRenderMember(item.ProcessedBy) }}</span>
                  </div>
                  <div class="form-group col-3">
                    <label class="label-custom" for="Name">Ngày duyệt: </label>
                    <span *ngIf="item.ProcessedAt">
                      {{ handleRenderDate(item.ProcessedAt) }}</span
                    >
                  </div>
                  <div class="form-group col-3">
                    <label class="label-custom" for="Name"
                      >Kết quả duyệt:
                    </label>
                    <span> {{ handleRenderResult(item.Result) }}</span>
                  </div>
                  <div class="form-group col-3">
                    <label class="label-custom" for="Name"
                      >Lần duyệt:&nbsp;</label
                    >
                    <span>{{ aprovedTimes1 - i }}</span>
                  </div>
                </div>
                <div class="row">
                  <div class="form-group col">
                    <label
                      class="label-custom"
                      for="Name"
                      (click)="toggleCommentVisibility1(i)"
                    >
                      <div style="display: flex; align-items: center">
                        <div
                          style="
                            margin-right: 10px;
                            font-size: 23px;
                            margin-top: -6px;
                          "
                        >
                          {{
                            i === selectedCommentIndex1 && isCommentVisible1
                              ? "-"
                              : "+"
                          }}
                        </div>
                        Nhận xét
                      </div>
                    </label>
                  </div>
                </div>
  
                <div
                  class="row"
                  *ngIf="isCommentVisible1 && i === selectedCommentIndex1"
                >
                  <div class="form-group col">
                    <app-textarea-input
                      [multiline]="true"
                      [readonly]="true"
                      (newItemEvent)="onInputCommentClose($event)"
                      key="Comment"
                      [value]="item !== undefined ? item.Comment : ''"
                    ></app-textarea-input>
                  </div>
                </div>
              </form>
            </div>
          </div>
          <div #container class="root-container"></div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
<app-video-compressor
  *ngIf="open"
  (addSuccess)="onSuccessUploadPart($event)"
  (onHideModal)="onHideModal()"
  [idUploadPart]="uploadPartId"
></app-video-compressor>

<div #container class="root-container"></div>
<ejs-dialog #ejDialogProgress [visible]="false" [target]="targetElement" width="300px">
</ejs-dialog>
<div #container class="root-container"></div>
<ejs-dialog #ejDialogVideo [visible]="false" [target]="targetElement" width="300px">
</ejs-dialog>